library(car)
library(lme4)
library(lmerTest)
library(DHARMa)
cactus<-read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/cactus.csv", stringsAsFactors = T)
bud_betabin <- glmmTMB(TotFlowerbuds_t~logsize_t,family="negative binomial"(link="log"),data=cactus)
bud_betabin <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus)
(bud_betabin <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
cactus_buds_siz <-glm(TotFlowerbuds_t~logsize_t,family="poisson",data=cactus)
summary(cactus_buds_siz)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
x_siz <-seq(from=min(cactus$logsize_t,na.rm=T), to=max(cactus$logsize_t,na.rm=T), by=0.1)
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Flower Bud Production",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,log(coef(cactus_buds_siz)[1]+coef(cactus_buds_siz)[2]*x_siz),col="grey0", lty=1, lwd=2)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
lines(x_siz,log(coef(cacbud_nbi)[1]+coef(cacbud_nbi)[2]*x_siz),col="grey0", lty=1, lwd=2)
cactus_buds_siz <-glm(TotFlowerbuds_t~logsize_t,family="poisson",data=cactus)
summary(cactus_buds_siz)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
cactus_buds_siz <-glm(TotFlowerbuds_t~logsize_t,family="poisson",data=cactus)
summary(cactus_buds_siz)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
x_siz <-seq(from=min(cactus$logsize_t,na.rm=T), to=max(cactus$logsize_t,na.rm=T), by=0.1)
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Flower Bud Production",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,log(coef(cactus_buds_siz)[1]+coef(cactus_buds_siz)[2]*x_siz),col="grey0", lty=1, lwd=2)
x_siz <-seq(from=min(cactus$logsize_t,na.rm=T), to=max(cactus$logsize_t,na.rm=T), by=0.1)
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Flower Bud Production",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,exp(coef(cactus_buds_siz)[1]+coef(cactus_buds_siz)[2]*x_siz),col="grey0", lty=1, lwd=2)
(cactus_buds_siz_yr <-glmer(TotFlowerbuds_t~logsize_t+(1|Year_t),family="poisson",data=cactus))
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Number of Flower Buds",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,exp(fixef(cactus_buds_siz_yr)[1]+fixef(cactus_buds_siz_yr)[2]*x_siz),col="grey0", lty=1, lwd=2)
str(cactus)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus)
summary(cacbud_nbi)
cactus_buds_siz <-glm(TotFlowerbuds_t~logsize_t,family="poisson",data=cactus)
summary(cactus_buds_siz)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(car)
library(lme4)
library(lmerTest)
library(DHARMa)
cactus<-read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/cactus.csv", stringsAsFactors = T)
str(cactus)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(car)
library(lme4)
library(lmerTest)
library(DHARMa)
cactus<-read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/cactus.csv", stringsAsFactors = T)
str(cactus)
cactus_buds_siz <-glm(TotFlowerbuds_t~logsize_t,family="poisson",data=cactus)
summary(cactus_buds_siz)
cacbs_resids <- DHARMa::simulateResiduals(cactus_buds_siz)
plot(cacbs_resids)
(cacbud_nbi <- glmmTMB(TotFlowerbuds_t~logsize_t,family="nbinom1"(link="log"),data=cactus))
summary(cacbud_nbi)
x_siz <-seq(from=min(cactus$logsize_t,na.rm=T), to=max(cactus$logsize_t,na.rm=T), by=0.1)
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Flower Bud Production",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,exp(coef(cactus_buds_siz)[1]+coef(cactus_buds_siz)[2]*x_siz),col="grey0", lty=1, lwd=2)
(cactus_buds_siz_yr <-glmer(TotFlowerbuds_t~logsize_t+(1|Year_t),family="poisson",data=cactus))
plot(jitter(cactus$logsize_t), jitter(cactus$TotFlowerbuds_t),
xlab= "log size (mm)",
ylab= "total number of flower buds",
main= "Effect of Plant Size on Number of Flower Buds",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
lines(x_siz,exp(fixef(cactus_buds_siz_yr)[1]+fixef(cactus_buds_siz_yr)[2]*x_siz),col="grey0", lty=1, lwd=2)
str(compcoe)
##Survival
(Surv_spkt_yrt_end<-glmer(surv_t1~logsize_t+(1|year_t),family="binomial",data=poasyl))
##Survival
(Surv_spkt_yrt_end<-glmer(surv_t1~size_t+(1|year_t),family="binomial",data=poasyl))
summary(Surv_spkt_yrt_end)
##Survival
(Surv_spkt_yrt_end<-glmer(surv_t1~size_t+(1|year_t),family="binomial",data=poasyl))
summary(Surv_spkt_yrt_end)
PSux_smnP<-seq(from=min(PEndP$surv_t1), to=max(PEndP$surv_t1), by=1)
PSux_smnN<-seq(from=min(PEndN$surv_t1), to=max(PEndN$surv_t1), by=1)
plot(jitter(poasyl$surv_t1),jitter(poasyl$surv_t1),
pch=poasyl$pttype,
col= poasyl$color,
bg=alpha(poasyl$coloUrvar, 0.6),
xlab = "# of spikelets at year t",
ylab = "# of spikelets at year t+1 (# of tillers)",
main = "Effect of year on spikelet count of E+ and E- plants",
cex=1.25)
legend("topright",legend=c("E+","E-"),
pch=c(21,23),
pt.cex=1,
cex=1,
col=c("slateblue4","goldenrod4"),
pt.bg=alpha(c("first" = "slateblue", "second" = "goldenrod"), 0.6))
##change in spikelet count
(spktt_spkt_yrt_end <- glmer(mean_spike_t1 ~ mean_spike_t * endo_01 + (mean_spike_t|year_t), family="poisson", data=poasyl))
summary(spktt_spkt_yrt_end)
PSpx_smnP<-seq(from=min(PEndP$mean_spike_t), to=max(PEndP$mean_spike_t), by=1)
##Survival
(Surv_spkt_yrt_end<-glmer(surv_t1~size_t+(1|year_t),family="binomial",data=poasyl))
summary(Surv_spkt_yrt_end)
PSux_smnP<-seq(from=min(PEndP$surv_t1), to=max(PEndP$surv_t1), by=1)
legend("topright",legend=c("E+","E-"),
pch=c(21,23),
pt.cex=1,
cex=1,
col=c("slateblue4","goldenrod4"),
pt.bg=alpha(c("first" = "slateblue", "second" = "goldenrod"), 0.6))
plot(jitter(poasyl$surv_t1),jitter(poasyl$surv_t1),
pch=poasyl$pttype,
col= poasyl$color,
bg=alpha(poasyl$coloUrvar, 0.6),
xlab = "size at year t (# of tillers)",
ylab = "survival",
main = "Effect of initial size on survival",
cex=1.25)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
str(ilex)
nrow(ilex)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
str(ilex)
view(ilex)
nrow(ilex)
level(ilex$Location)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv", stringsAsFactors = T)
str(ilex)
view(ilex)
nrow(ilex)
level(ilex$Location)
nrow(ilex)
levels(ilex$Location)
nrow(ilex)
levels
ilex %>% group_by(Location) %>% summarise(n())
nrow(ilex)
ilex %>% group_by(Location) %>% summarise(n())
nrow(ilex)
ilex %>% group_by(Location) %>% summarise(n()) %>% arrange(desc(n))
nrow(ilex)
ilex %>% group_by(Location) %>% arrange(desc(n))
nrow(ilex)
ilex %>% group_by(Location) %>% summarise(n())
nrow(ilex)
ilex %>% group_by(Location) %>% summarise(n())
ilex %>% group_by(Location) %>% summarise(n(length=1))
nrow(ilex)
ilex %>% group_by(Location) %>% summarise(n())
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv", stringsAsFactors = T)
str(ilex)
view(ilex)
summary(ilex$mean_temp_30yrnorm)
mean(ilex$mean_temp_30yrnorm)
summary(ilex$mean_temp_30yrnorm)
(profemtrees <- ilex$females / (ilex$females + ilex$males))
(profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex))
str(ilex)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
str(ilex)
view(ilex)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
str(ilex)
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
(str(ilex))
knitr::opts_chunk$set(echo = TRUE)
ilex <- read.csv("/Users/akiemgough/Desktop/CLASSES 2024/BIO DATA/Biodata_Directory/ilex.csv")
str(ilex)
(profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (ilex$mean_temp_30yrnorm, ilex)
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
ilex
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$)profemtrees)
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25)))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= 1.15,
col= "magenta4",
bg=alpha("magenta2", 0.25))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= cactus$TotFlowerbuds_t,
col= "magenta4",
bg=alpha("magenta2", 0.25))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$Location,
col= "magenta4",
bg=alpha("magenta2", 0.25))
(ilex$tottrees <- ilex$females + ilex$males)
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.25))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$females),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.25))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.25))
prob_treefem <- glm(cbind(females,tottrees)~mean_temp_30yrnorm,family="binomial",data=ilex)
(prob_treefem <- glm(cbind(females,tottrees)~mean_temp_30yrnorm,family="binomial",data=ilex))
(prob_treefem <- glm(cbind(females,tottrees)~mean_temp_30yrnorm,family="binomial",data=ilex))
summary(prob_treefem)
ilex
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.25))
x_tempon <-seq(from=min(ilex$mean_temp_30yrnorm), to=max(ilex$mean_temp_30yrnorm), by=0.1)
lines(x_tempon,exp(coef(prob_treefem)[1]+coef(prob_treefem)[2]*x_tempon),col="grey0", lty=1, lwd=2)
library(DHARMa)
simulateResiduals(prob_treefem)
prob_treefem_resid <- DHARMa::simulateResiduals(prob_treefem)
plot(prob_treefem_resid)
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.2))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "magenta4",
bg=alpha("magenta2", 0.15))
(ilex$profemtrees <- ilex$females / (ilex$females + ilex$males))
(ilex$tottrees <- ilex$females + ilex$males)
plot (jitter(ilex$mean_temp_30yrnorm), jitter(ilex$profemtrees),
xlab= "30-year normal mean temperature (°F)",
ylab= "proportion of female trees",
pch= 21,
cex= ilex$tottrees,
col= "green",
bg=alpha("magenta2", 0.15))
###Importing data set
compcoe <- read.csv("/Users/akiemgough/Desktop/RESEARCH/Datar/ltreb_allspp_qaqc.csv",stringsAsFactors = T)
library(tidyverse)
library(scales)
library(lme4)
library(car)
library(AICcmodavg)
library(glmmTMB)
##Making columns for color distinctions for endophyte status
compcoe$colorvar <- case_when(compcoe$endo_01 == 1 ~"slateblue4",compcoe$endo_01 == 0 ~"goldenrod4")
compcoe$coloUrvar <- case_when(compcoe$endo_01 == 1 ~"slateblue",compcoe$endo_01 == 0 ~"goldenrod")
##Filtering for Poa Alsodes
poaals <- compcoe %>% filter(species == "POAL")
str(poaals)
poaals
##making year x variables for graphs
(x_yrs<- seq(from=2007,to=2021,by=1))
##making size x variables for graphs
(size_dummy<-seq(from=0,to=max(log(poaals$size_t),na.rm=T),by=0.1))
##coercing year into a factor
year_tf <- as.factor(poaals$year_t)
#creating logistic function
logistic<-function(x){1/(1+exp(-x))}
## now add year random slopes
poal_flow_mod5<- glmer(flw_count_t>0~endo_01*log(size_t)+(endo_01|year_t),family="binomial", data=poaals)
ranef(poal_flow_mod5)
coef(poal_flow_mod5)$year_t
plot(poaals$year_t,jitter(as.integer(poaals$flw_count_t>0),amount=0.02))
flow_mod5_Eminus_intercepts<-coef(poal_flow_mod5)$year_t[,1]
flow_mod5_Eminus_slopes<-coef(poal_flow_mod5)$year_t[,3]
flow_mod5_Eplus_intercepts<-coef(poal_flow_mod5)$year_t[,1]+coef(poal_flow_mod5)$year_t[,2]
flow_mod5_Eplus_slopes<-coef(poal_flow_mod5)$year_t[,3]+coef(poal_flow_mod5)$year_t[,4]
lines(x=x_yrs,y=logistic(flow_mod5_Eminus_slopes+flow_mod5_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod5_Eplus_intercepts+flow_mod5_Eplus_slopes), col="slateblue", lty=2, type="b")
summary(poal_flow_mod5)
##plotting flower count against year
plot(jitter(poaals$year_t, amount=0.35),jitter(poaals$flw_count_t, amount=0.035),
pch=21,
col= poaals$colorvar,
bg=alpha(poaals$coloUrvar, 0.2),
xlab = "year",
ylab = "# of flowering tillers",
main = "Effect of year on flower count",
cex=1.25)
legend("bottomright",legend=c("E+","E-"),
inset = c(0,0.17),
pch=21,
pt.cex=1,
cex=1,
col=c("slateblue4","goldenrod4"),
pt.bg=alpha(c("first" = "slateblue", "second" = "goldenrod"), 0.2))
##adding lines to the plot
#get model estimates for E- survival by year
flw_Eminus<-c(coef(flw_yrt_end)[1],coef(flw_yrt_end)[1]+coef(flw_yrt_end)[2:15])
names(flw_Eminus)<-x_yrs
#get model estimates for E+ survival by year
flw_Eplus<-c (coef(flw_yrt_end)[1] + coef(flw_yrt_end)[16], coef(flw_yrt_end)[1] +
coef(flw_yrt_end)[16] + coef(flw_yrt_end)[2:15] + coef(flw_yrt_end)[17:30])
names(flw_Eplus)<-x_yrs
#adding lines
lines(x=x_yrs, y=exp(flw_Eminus),col="goldenrod", lty=1, lwd=4, type="b")
lines(x=x_yrs, y=exp(flw_Eplus),col="slateblue", lty=1, lwd=4, type="b")
##fitting generalized linear model for effect of year and/or endophyte status on # of flowering tillers
(flw_yrt_end<-glm(flw_count_t~year_tf*endo_01, family="poisson",data=poaals))
summary(flw_yrt_end)
coef(flw_yrt_end)
##plotting flower count against year
plot(jitter(poaals$year_t, amount=0.35),jitter(poaals$flw_count_t, amount=0.035),
pch=21,
col= poaals$colorvar,
bg=alpha(poaals$coloUrvar, 0.2),
xlab = "year",
ylab = "# of flowering tillers",
main = "Effect of year on flower count",
cex=1.25)
legend("bottomright",legend=c("E+","E-"),
inset = c(0,0.17),
pch=21,
pt.cex=1,
cex=1,
col=c("slateblue4","goldenrod4"),
pt.bg=alpha(c("first" = "slateblue", "second" = "goldenrod"), 0.2))
##adding lines to the plot
#get model estimates for E- survival by year
flw_Eminus<-c(coef(flw_yrt_end)[1],coef(flw_yrt_end)[1]+coef(flw_yrt_end)[2:15])
names(flw_Eminus)<-x_yrs
#get model estimates for E+ survival by year
flw_Eplus<-c (coef(flw_yrt_end)[1] + coef(flw_yrt_end)[16], coef(flw_yrt_end)[1] +
coef(flw_yrt_end)[16] + coef(flw_yrt_end)[2:15] + coef(flw_yrt_end)[17:30])
names(flw_Eplus)<-x_yrs
#adding lines
lines(x=x_yrs, y=exp(flw_Eminus),col="goldenrod", lty=1, lwd=4, type="b")
lines(x=x_yrs, y=exp(flw_Eplus),col="slateblue", lty=1, lwd=4, type="b")
plot(poaals$year_t,jitter(as.integer(poaals$flw_count_t>0),amount=0.02))
flow_mod5_Eminus_intercepts<-coef(poal_flow_mod5)$year_t[,1]
flow_mod5_Eminus_slopes<-coef(poal_flow_mod5)$year_t[,3]
flow_mod5_Eplus_intercepts<-coef(poal_flow_mod5)$year_t[,1]+coef(poal_flow_mod5)$year_t[,2]
flow_mod5_Eplus_slopes<-coef(poal_flow_mod5)$year_t[,3]+coef(poal_flow_mod5)$year_t[,4]
lines(x=x_yrs,y=logistic(flow_mod5_Eminus_slopes+flow_mod5_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod5_Eplus_intercepts+flow_mod5_Eplus_slopes), col="slateblue", lty=2, type="b")
coef(poal_flow_mod5)$year_t
plot(poaals$year_t,jitter(as.integer(poaals$flw_count_t>0),amount=0.02))
flow_mod5_Eminus_intercepts<-coef(poal_flow_mod5)$year_t[,1]
flow_mod5_Eminus_slopes<-coef(poal_flow_mod5)$year_t[,3]
flow_mod5_Eplus_intercepts<-coef(poal_flow_mod5)$year_t[,1]+coef(poal_flow_mod5)$year_t[,2]
lines(x=x_yrs,y=logistic(flow_mod5_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod5_Eplus_intercepts), col="slateblue", lty=2, type="b")
?scale
##Tom adding standardization of size variable
hist(log(poaals$size_t))
hist(scale(log(poaals$size_t),center=T,scale=F))
hist(scale(log(poaals$size_t),center=T,scale=T))
hist(scale(log(poaals$size_t),center=T,scale=F))
poaals$log_tillers_centered <- log(poaals$size_t) - mean(log(poaals$size_t),na.rm=T)
hist(poaals$log_tillers_centered)
hist(scale(log(poaals$size_t),center=T,scale=F))
mean(log(poaals$size_t),na.rm=T)
mean(poaals$log_tillers_centered)
mean(poaals$log_tillers_centered,na.rm=T)
## now refit model
poal_flow_mod6<- glmer(flw_count_t>0~endo_01*log_tillers_centered+(endo_01|year_t),family="binomial", data=poaals)
flow_mod6_Eminus_intercepts<-coef(poal_flow_mod5)$year_t[,1]
flow_mod6_Eplus_intercepts<-coef(poal_flow_mod5)$year_t[,1]+coef(poal_flow_mod5)$year_t[,2]
plot(poaals$year_t,jitter(as.integer(poaals$flw_count_t>0),amount=0.02))
lines(x=x_yrs,y=logistic(flow_mod6_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod6_Eplus_intercepts), col="slateblue", lty=2, type="b")
poaals$log_tillers_centered <- log(poaals$size_t) - median(log(poaals$size_t),na.rm=T)
##equivaently:
hist(scale(log(poaals$size_t),center=T,scale=F))
poaals$log_tillers_centered <- log(poaals$size_t) - median(log(poaals$size_t),na.rm=T)
## now refit model
poal_flow_mod6<- glmer(flw_count_t>0~endo_01*log_tillers_centered+(endo_01|year_t),family="binomial", data=poaals)
flow_mod6_Eminus_intercepts<-coef(poal_flow_mod5)$year_t[,1]
flow_mod6_Eplus_intercepts<-coef(poal_flow_mod5)$year_t[,1]+coef(poal_flow_mod5)$year_t[,2]
lines(x=x_yrs,y=logistic(flow_mod6_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod6_Eplus_intercepts), col="slateblue", lty=2, type="b")
plot(poaals$year_t,jitter(as.integer(poaals$flw_count_t>0),amount=0.02))
lines(x=x_yrs,y=logistic(flow_mod6_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod6_Eplus_intercepts), col="slateblue", lty=2, type="b")
poaals$log_tillers_centered <- log(poaals$size_t) - mean(log(poaals$size_t),na.rm=T)
plot(x=x_yrs,y=logistic(flow_mod6_Eminus_intercepts), col="goldenrod", lty=2, type="b")
lines(x=x_yrs,y=logistic(flow_mod6_Eplus_intercepts), col="slateblue", lty=2, type="b")
coef(poal_flow_mod5)$year_t
## load packages
library(googledrive)
library(readxl)
library(tidyverse)
##set wriking directory
setwd("~/Documents/GitHub/Temporal-Storage")
ltrebman <- read.csv("data/ltreb_allspp_qaqc.csv",stringsAsFactors = T)
## to be sorted out
##it seems I don't have the permission to grab this data file from the google drive
string23 <- "1QhWF-7SbvjAAhsfbXMNdA1IWEwSf1kBe"
drive_download(as_id(string23), path = "data/LTREB_data_2024_recruits_inc.xlsx", overwrite=TRUE)
